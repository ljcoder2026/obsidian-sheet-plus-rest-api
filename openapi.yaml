openapi: 3.0.0
info:
  title: Obsidian Sheet Plus REST API
  version: 1.0.0
  description: API documentation for Obsidian Sheet Plus plugin
servers:
  - url: http://127.0.0.1:{port}
    description: Local server (custom port)
    variables:
      port:
        default: '3000'
        description: Input any running port
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-KEY
      description: API Key authentication
security:
  - ApiKeyAuth: []
paths:
  /get_workbook_data:
    get:
      summary: Get Workbook Data
      description: Get full workbook data
      tags:
        - Workbook
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters: []
  /get_sheet_list:
    get:
      summary: Get Sheet List
      description: Get all sheets in the current workbook
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters: []
  /get_sheet_data:
    get:
      summary: Get Sheet Data
      description: Get data from a sheet
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters:
        - in: query
          name: sheetName
          required: false
          schema:
            type: string
            description: Sheet name
          description: Sheet name
        - in: query
          name: range
          required: false
          schema:
            type: string
            description: Data range, e.g., A1:B10
          description: Data range, e.g., A1:B10
  /create_sheet:
    post:
      summary: Create Sheet
      description: Create a new sheet in the workbook
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
              required:
                - sheetName
  /set_sheet_data:
    post:
      summary: Set Sheet Data
      description: Update data in a sheet
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Data range, e.g., A1:B10
                values:
                  type: array
                  description: Data to update, 2D array
                  items:
                    type: array
                    items:
                      type: any
              required:
                - range
                - values
  /set_formula:
    post:
      summary: Set Formula
      description: Set formula in specified cells
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1 or A1:B10
                formula:
                  type: string
                  description: Formula, e.g., =SUM(B1:B10)
              required:
                - range
                - formula
  /set_range_style:
    post:
      summary: Set Range Style
      description: >-
        Set style for specified range, including font, color, background,
        borders, etc.
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
                style:
                  type: object
                  description: >-
                    Style object to set, including font, color, background,
                    borders, etc.
                  properties:
                    backgroundColor:
                      type: string
                      description: 'Background color, e.g., #FFFF00'
                    fontColor:
                      type: string
                      description: 'Font color, e.g., #0000FF'
                    fontSize:
                      type: number
                      description: >-
                        A font size in point size. A null value resets the font
                        size.
                    fontFamily:
                      type: string
                      description: >-
                        he font family to set; a null value resets the font
                        family.
                    fontLine:
                      type: string
                      enum:
                        - none
                        - single
                        - double
                      description: >-
                        The font line style, either ‘underline’, ‘line-through’,
                        or ‘none’; a null value resets the font line style.
                    fontWeight:
                      type: string
                      enum:
                        - normal
                        - bold
                      description: >-
                        The font weight, either ‘normal’ or ‘bold’; a null value
                        resets the font weight.
                    fontStyle:
                      type: string
                      enum:
                        - normal
                        - italic
                      description: >-
                        The font style, either ‘italic’ or ‘normal’; a null
                        value resets the font style.
                    textDecoration:
                      type: string
                      enum:
                        - none
                        - underline
                        - line-through
                      description: Text decoration
                    horizontalAlignment:
                      type: string
                      enum:
                        - left
                        - center
                        - right
                      description: >-
                        Set the horizontal (left to right) alignment for the
                        given range (left/center/right).
                    verticalAlignment:
                      type: string
                      enum:
                        - top
                        - middle
                        - bottom
                      description: >-
                        Set the vertical (top to bottom) alignment for the given
                        range (top/middle/bottom).
                    textRotation:
                      type: number
                      description: >-
                        Set the text rotation angle for the given range (0-360
                        degrees).
                    wrap:
                      type: boolean
                      description: >-
                        Set the cell wrap of the given range. Cells with wrap
                        enabled (the default) resize to display their full
                        content. Cells with wrap disabled display as much as
                        possible in the cell without resizing or running to
                        multiple lines.
                    border:
                      type: object
                      description: Border style
                      properties:
                        type:
                          type: string
                          enum:
                            - top
                            - bottom
                            - left
                            - right
                            - none
                            - all
                            - outside
                            - inside
                            - horizontal
                            - vertical
                            - tlbr
                            - tlbc_tlmr
                            - tlbr_tlbc_tlmr
                            - bl_tr
                            - mltr_bctr
                          description: Border type, e.g., all for all borders
                        style:
                          type: number
                          enum:
                            - 0
                            - 1
                            - 2
                            - 3
                            - 4
                            - 5
                            - 6
                            - 7
                            - 8
                            - 9
                            - 10
                            - 11
                            - 12
                            - 13
                          description: >-
                            Border style, e.g., NONE = 0, THIN = 1, HAIR = 2,
                            DOTTED = 3, DASHED = 4, DASH_DOT = 5, DASH_DOT_DOT =
                            6, DOUBLE = 7, MEDIUM = 8, MEDIUM_DASHED = 9,
                            MEDIUM_DASH_DOT = 10, MEDIUM_DASH_DOT_DOT = 11,
                            SLANT_DASH_DOT = 12, THICK = 13
                        color:
                          color:
                            type: string
                            description: Border color
              required:
                - range
                - style
  /clear_contents:
    post:
      summary: Clear Contents
      description: Clear contents of specified sheet cell range
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /clear_format:
    post:
      summary: Clear Format
      description: Clear formats of specified sheet cell range
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /set_data_validation:
    post:
      summary: Set Data Validation
      description: Set data validation for specified cell range
      tags:
        - Data Validation
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
                type:
                  type: string
                  enum:
                    - whole
                    - decimal
                    - list
                    - listMultiple
                    - date
                    - time
                    - textLength
                    - custom
                    - checkbox
                    - any
                  description: >-
                    Data validation type, e.g., whole, decimal, list, date,
                    time, textLength, custom, checkbox, or any
                formula1:
                  type: string
                  description: >-
                    A formula or value, e.g., for list or listMultiple type,
                    value is "1,2,3" with comma-separated options. For checkbox,
                    use TRUE. For other types, use value or formula.
                formula2:
                  type: string
                  description: >-
                    A formula or value, e.g., for list or listMultiple type,
                    value is "#222222,#222222,#222222" with comma-separated
                    colors. For checkbox, use FALSE. For other types, required
                    if operator is not equal or notEqual.
                operator:
                  type: string
                  enum:
                    - between
                    - notBetween
                    - equal
                    - notEqual
                    - greaterThan
                    - lessThan
                    - greaterThanOrEqual
                    - lessThanOrEqual
                  description: Operator, e.g., between, equal, greaterThan, etc.
                allowBlank:
                  type: boolean
                  description: Whether to allow blank cells
                showErrorMessage:
                  type: boolean
                  description: Whether to show error message
                errorMessage:
                  type: string
                  description: Error message content
              required:
                - range
                - type
                - formula1
  /clear_data_validation:
    post:
      summary: Clear Data Validation
      description: Delete data validation rules for specified sheet cell range
      tags:
        - Data Validation
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
tags:
  - name: Workbook
    description: Workbook related operations
  - name: Sheets
    description: Sheet related operations
  - name: Data Validation
    description: Data validation related operations
