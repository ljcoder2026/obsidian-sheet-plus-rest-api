openapi: 3.0.0
info:
  title: Obsidian Sheet Plus REST API
  version: 1.0.0
  description: API documentation for Obsidian Sheet Plus plugin
servers:
  - url: http://127.0.0.1:{port}
    description: Local server (custom port)
    variables:
      port:
        default: '3000'
        description: Input any running port
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-KEY
      description: API Key authentication
security:
  - ApiKeyAuth: []
paths:
  /get_workbook_data:
    get:
      summary: Get Workbook Data
      description: Get full workbook data
      tags:
        - Workbook
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters: []
  /get_sheet_list:
    get:
      summary: Get Sheet List
      description: Get all sheets in the current workbook
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters: []
  /get_max_rows:
    get:
      summary: Get Max Rows
      description: Get the maximum number of rows in a sheet
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters:
        - in: query
          name: sheetName
          required: false
          schema:
            type: string
            description: Sheet name
          description: Sheet name
  /get_max_columns:
    get:
      summary: Get Max Columns
      description: Get the maximum number of columns in a sheet
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters:
        - in: query
          name: sheetName
          required: false
          schema:
            type: string
            description: Sheet name
          description: Sheet name
  /get_sheet_data:
    get:
      summary: Get Sheet Data
      description: Get data from a sheet
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      parameters:
        - in: query
          name: sheetName
          required: false
          schema:
            type: string
            description: Sheet name
          description: Sheet name
        - in: query
          name: range
          required: false
          schema:
            type: string
            description: Data range, e.g., A1:B10
          description: Data range, e.g., A1:B10
  /create_sheet:
    post:
      summary: Create Sheet
      description: Create a new sheet in the workbook
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
              required:
                - sheetName
  /set_sheet_data:
    post:
      summary: Set Sheet Data
      description: Update data in a sheet
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Data range, e.g., A1:B10
                values:
                  type: array
                  description: Data to update, 2D array
                  items:
                    type: array
                    items:
                      type: any
              required:
                - range
                - values
  /set_formula:
    post:
      summary: Set Formula
      description: Set formula in specified cells
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1 or A1:B10
                formula:
                  type: string
                  description: Formula, e.g., =SUM(B1:B10)
              required:
                - range
                - formula
  /set_range_style:
    post:
      summary: Set Range Style
      description: >-
        Set style for specified range, including font, color, background,
        borders, etc.
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
                style:
                  type: object
                  description: >-
                    Style object to set, including font, color, background,
                    borders, etc.
                  properties:
                    backgroundColor:
                      type: string
                      description: 'Background color, e.g., #FFFF00'
                    fontColor:
                      type: string
                      description: 'Font color, e.g., #0000FF'
                    fontSize:
                      type: number
                      description: >-
                        A font size in point size. A null value resets the font
                        size.
                    fontFamily:
                      type: string
                      description: >-
                        he font family to set; a null value resets the font
                        family.
                    fontLine:
                      type: string
                      enum:
                        - none
                        - single
                        - double
                      description: >-
                        The font line style, either ‘underline’, ‘line-through’,
                        or ‘none’; a null value resets the font line style.
                    fontWeight:
                      type: string
                      enum:
                        - normal
                        - bold
                      description: >-
                        The font weight, either ‘normal’ or ‘bold’; a null value
                        resets the font weight.
                    fontStyle:
                      type: string
                      enum:
                        - normal
                        - italic
                      description: >-
                        The font style, either ‘italic’ or ‘normal’; a null
                        value resets the font style.
                    textDecoration:
                      type: string
                      enum:
                        - none
                        - underline
                        - line-through
                      description: Text decoration
                    horizontalAlignment:
                      type: string
                      enum:
                        - left
                        - center
                        - right
                      description: >-
                        Set the horizontal (left to right) alignment for the
                        given range (left/center/right).
                    verticalAlignment:
                      type: string
                      enum:
                        - top
                        - middle
                        - bottom
                      description: >-
                        Set the vertical (top to bottom) alignment for the given
                        range (top/middle/bottom).
                    textRotation:
                      type: number
                      description: >-
                        Set the text rotation angle for the given range (0-360
                        degrees).
                    wrap:
                      type: boolean
                      description: >-
                        Set the cell wrap of the given range. Cells with wrap
                        enabled (the default) resize to display their full
                        content. Cells with wrap disabled display as much as
                        possible in the cell without resizing or running to
                        multiple lines.
                    border:
                      type: object
                      description: Border style
                      properties:
                        type:
                          type: string
                          enum:
                            - top
                            - bottom
                            - left
                            - right
                            - none
                            - all
                            - outside
                            - inside
                            - horizontal
                            - vertical
                            - tlbr
                            - tlbc_tlmr
                            - tlbr_tlbc_tlmr
                            - bl_tr
                            - mltr_bctr
                          description: Border type, e.g., all for all borders
                        style:
                          type: number
                          enum:
                            - 0
                            - 1
                            - 2
                            - 3
                            - 4
                            - 5
                            - 6
                            - 7
                            - 8
                            - 9
                            - 10
                            - 11
                            - 12
                            - 13
                          description: >-
                            Border style, e.g., NONE = 0, THIN = 1, HAIR = 2,
                            DOTTED = 3, DASHED = 4, DASH_DOT = 5, DASH_DOT_DOT =
                            6, DOUBLE = 7, MEDIUM = 8, MEDIUM_DASHED = 9,
                            MEDIUM_DASH_DOT = 10, MEDIUM_DASH_DOT_DOT = 11,
                            SLANT_DASH_DOT = 12, THICK = 13
                        color:
                          color:
                            type: string
                            description: Border color
              required:
                - range
                - style
  /clear_contents:
    post:
      summary: Clear Contents
      description: Clear contents of specified sheet cell range
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /clear_format:
    post:
      summary: Clear Format
      description: Clear formats of specified sheet cell range
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /clear_all:
    post:
      summary: Clear All
      description: Clear all contents and formats of specified sheet cell range
      tags:
        - Sheets
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /insert_rows:
    post:
      summary: Insert Rows
      description: Insert new rows at a specified position
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                rowIndex:
                  type: number
                  description: Row index where to insert new rows (0-based)
                numberOfRows:
                  type: number
                  description: Number of rows to insert
              required:
                - rowIndex
                - numberOfRows
  /delete_rows:
    post:
      summary: Delete Rows
      description: Delete rows at a specified position
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                rowIndex:
                  type: number
                  description: Row index where to start deleting (0-based)
                numberOfRows:
                  type: number
                  description: Number of rows to delete
              required:
                - rowIndex
                - numberOfRows
  /insert_columns:
    post:
      summary: Insert Columns
      description: Insert new columns at a specified position
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                columnIndex:
                  type: number
                  description: Column index where to insert new columns (0-based)
                numberOfColumns:
                  type: number
                  description: Number of columns to insert
              required:
                - columnIndex
                - numberOfColumns
  /delete_columns:
    post:
      summary: Delete Columns
      description: Delete columns at a specified position
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                columnIndex:
                  type: number
                  description: Column index where to start deleting (0-based)
                numberOfColumns:
                  type: number
                  description: Number of columns to delete
              required:
                - columnIndex
                - numberOfColumns
  /auto_resize_rows:
    post:
      summary: Auto Resize Rows
      description: Auto resize multiple rows to fit their content
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                startRow:
                  type: number
                  description: Starting row index (0-based)
                numberOfRows:
                  type: number
                  description: Number of rows to resize
              required:
                - startRow
                - numberOfRows
  /auto_resize_columns:
    post:
      summary: Auto Resize Columns
      description: Auto resize multiple columns to fit their content
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                startColumn:
                  type: number
                  description: Starting column index (0-based)
                numberOfColumns:
                  type: number
                  description: Number of columns to resize
              required:
                - startColumn
                - numberOfColumns
  /merge_cells:
    post:
      summary: Merge Cells
      description: Merge cells in a specified range
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range to merge, e.g., A1:B2
              required:
                - range
  /unmerge_cells:
    post:
      summary: Unmerge Cells
      description: Unmerge (break apart) merged cells in a specified range
      tags:
        - Row and Column Operations
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range to unmerge, e.g., A1:B2
              required:
                - range
  /set_data_validation:
    post:
      summary: Set Data Validation
      description: Set data validation for specified cell range
      tags:
        - Data Validation
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
                type:
                  type: string
                  enum:
                    - whole
                    - decimal
                    - list
                    - listMultiple
                    - date
                    - time
                    - textLength
                    - custom
                    - checkbox
                    - any
                  description: >-
                    Data validation type, e.g., whole, decimal, list, date,
                    time, textLength, custom, checkbox, or any
                formula1:
                  type: string
                  description: >-
                    A formula or value, e.g., for list or listMultiple type,
                    value is "1,2,3" with comma-separated options. For checkbox,
                    use TRUE. For other types, use value or formula.
                formula2:
                  type: string
                  description: >-
                    A formula or value, e.g., for list or listMultiple type,
                    value is "#222222,#222222,#222222" with comma-separated
                    colors. For checkbox, use FALSE. For other types, required
                    if operator is not equal or notEqual.
                operator:
                  type: string
                  enum:
                    - between
                    - notBetween
                    - equal
                    - notEqual
                    - greaterThan
                    - lessThan
                    - greaterThanOrEqual
                    - lessThanOrEqual
                  description: Operator, e.g., between, equal, greaterThan, etc.
                allowBlank:
                  type: boolean
                  description: Whether to allow blank cells
                showErrorMessage:
                  type: boolean
                  description: Whether to show error message
                errorMessage:
                  type: string
                  description: Error message content
              required:
                - range
                - type
                - formula1
  /clear_data_validation:
    post:
      summary: Clear Data Validation
      description: Delete data validation rules for specified sheet cell range
      tags:
        - Data Validation
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /add_conditional_formatting:
    post:
      summary: Add Conditional Formatting
      description: Add conditional formatting rule to a range
      tags:
        - Conditional Formatting
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
                ruleType:
                  type: string
                  enum:
                    - number
                    - text
                    - date
                    - cell
                    - average
                    - colorScale
                    - dataBar
                    - iconSet
                  description: Type of conditional formatting rule
                condition:
                  type: object
                  description: Condition settings based on rule type
                  properties:
                    operator:
                      type: string
                      enum:
                        - greaterThan
                        - lessThan
                        - equal
                        - greaterThanOrEqual
                        - lessThanOrEqual
                        - notEqual
                        - between
                        - notBetween
                      description: Number comparison operator
                    value1:
                      type: number
                      description: First value for comparison
                    value2:
                      type: number
                      description: Second value for between/notBetween operators
                    textOperator:
                      type: string
                      enum:
                        - contains
                        - notContains
                        - beginsWith
                        - endsWith
                      description: Text comparison operator
                    text:
                      type: string
                      description: Text to compare
                    dateOperator:
                      type: string
                      enum:
                        - today
                        - yesterday
                        - tomorrow
                        - last7Days
                        - thisMonth
                        - lastMonth
                        - nextMonth
                        - thisYear
                        - lastYear
                        - nextYear
                      description: Date comparison operator
                    cellType:
                      type: string
                      enum:
                        - empty
                        - notEmpty
                        - error
                        - noError
                      description: Cell type condition
                    averageOperator:
                      type: string
                      enum:
                        - above
                        - below
                        - equalOrAbove
                        - equalOrBelow
                        - aboveOrBelow
                      description: Average comparison operator
                    colorScale:
                      type: array
                      description: Color scale configuration
                      items:
                        type: object
                        properties:
                          index:
                            type: number
                            description: Color stop index
                          color:
                            type: string
                            description: Color for this stop
                          value:
                            type: object
                            properties:
                              type:
                                type: string
                                enum:
                                  - num
                                  - percent
                                  - percentile
                                description: Value type
                              value:
                                type: number
                                description: Value for this stop
                    dataBar:
                      type: object
                      properties:
                        positiveColor:
                          type: string
                          description: Color for positive values
                        nativeColor:
                          type: string
                          description: Color for negative values
                        isGradient:
                          type: boolean
                          description: Whether to use gradient
                        isShowValue:
                          type: boolean
                          description: Whether to show value
                        min:
                          type: object
                          properties:
                            type:
                              type: string
                              enum:
                                - num
                                - percent
                                - percentile
                                - formula
                                - auto
                              description: Minimum value type
                            value:
                              type: number
                              description: Minimum value
                        max:
                          type: object
                          properties:
                            type:
                              type: string
                              enum:
                                - num
                                - percent
                                - percentile
                                - formula
                                - auto
                              description: Maximum value type
                            value:
                              type: number
                              description: Maximum value
                    iconSet:
                      type: object
                      properties:
                        iconSetType:
                          type: string
                          description: Icon set type
                        reverseIconOrder:
                          type: boolean
                          description: Whether to reverse icon order
                        showIconOnly:
                          type: boolean
                          description: Whether to show only icons
                format:
                  type: object
                  description: Format settings for conditional formatting
                  properties:
                    backgroundColor:
                      type: string
                      description: 'Background color, e.g., #FF0000'
                    fontColor:
                      type: string
                      description: 'Font color, e.g., #FFFFFF'
                    bold:
                      type: boolean
                      description: Whether to bold text
                    italic:
                      type: boolean
                      description: Whether to italicize text
                    underline:
                      type: boolean
                      description: Whether to underline text
              required:
                - range
                - ruleType
                - condition
  /remove_conditional_formatting:
    post:
      summary: Remove Conditional Formatting
      description: Remove conditional formatting rules from a range
      tags:
        - Conditional Formatting
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
                range:
                  type: string
                  description: Cell range, e.g., A1:B10
              required:
                - range
  /clear_all_conditional_formatting:
    post:
      summary: Clear All Conditional Formatting
      description: Clear all conditional formatting rules from the entire sheet
      tags:
        - Conditional Formatting
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                  message:
                    type: string
                  error:
                    type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sheetName:
                  type: string
                  description: Sheet name
tags:
  - name: Workbook
    description: Workbook related operations
  - name: Sheets
    description: Sheet related operations
  - name: Data Validation
    description: Data validation related operations
  - name: Conditional Formatting
    description: Conditional formatting related operations
  - name: Row and Column Operations
    description: Row and column related operations
